/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/6.7/samples
 */

plugins {
	id 'java-library'
	id 'application' 
}

version = '0.3'
group = 'xyz.binfish.misa'
mainClassName = 'xyz.binfish.misa.Main'

jar {
	baseName = rootProject.name

	manifest {
		attributes 'Manifest-Version': '1.0'
		attributes 'Implementation-Title': 'Misa in Jar'
		attributes 'Implementation-Version': version
		attributes 'Main-Class': mainClassName
	}

    from {
        duplicatesStrategy = DuplicatesStrategy.INCLUDE
        configurations.compileClasspath.collect { it.isDirectory() ? it : zipTree(it) }
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

repositories {
	mavenCentral()
	maven {
		name 'm2-dv8tion'
		url 'https://m2.dv8tion.net/releases'
	}

	jcenter()
}

dependencies {
	implementation('net.dv8tion:JDA:4.2.1_262') {
		exclude module: 'opus-java'
	}
	implementation group: 'mysql', name: 'mysql-connector-java', version: '5.1.46'
	implementation group: 'com.google.code.gson', name: 'gson', version: '2.8.8'
	implementation fileTree(dir: 'lib', include: ['*.jar'])
}

task createProperties(dependsOn: processResources) {
	doLast {
		new File("$buildDir/resources/main/app.properties").withWriter { w ->
			Properties props = new Properties()
			props['project.version'] = project.version.toString()
			props['project.groupId'] = project.group.toString()
			props['project.artifactId'] = 'Misa'
			props.store w, null
		}
	}
}

classes {
	dependsOn createProperties
}
